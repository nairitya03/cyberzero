class PenetrationTestingAgent:
    def __init__(self, llm, web_search_tool):
        self.llm = llm
        self.web_search_tool = web_search_tool

    def process(self, query: str) -> str:
        """Performs penetration testing tasks based on the given query."""
        prompt = f"""As a Penetration Testing expert, analyze the following query and provide a response:
        ########
        Query: 
        {query}
        
        ########
        - Your response Should only contain a security tools shell/bash command or complete working python3 code.
        - if you lack information about tools or linxu pack ages or python libraries, you can use the {self.web_search_tool} tool to make a web search about it and learn the workings of it.

        Note: 
        - You should only respond with working code or commands in a code block. EXAMPLE: ```\nprint("hello world")\n```
        - DO NOT ADD ANY TEXT BEFORE OR AFTER THE CODE blOCK
        """
        return self.llm.generate_response(prompt)

# The web_search_tool would be passed directly to the SOCManager as a separate tool